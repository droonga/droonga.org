msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"PO-Revision-Date: 2014-03-05 12:52+0900\n"
"Language: ja\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"

msgid ""
"---\n"
"title: \"Droonga tutorial: How to add a new replica to an existing cluster?\"\n"
"layout: en\n"
"---"
msgstr ""
"---\n"
"title: \"Droongaチュートリアル: 既存クラスタへのreplicaの追加\"\n"
"layout: ja\n"
"---"

msgid ""
"* TOC\n"
"{:toc}"
msgstr ""

msgid "## The goal of this tutorial"
msgstr "## チュートリアルのゴール"

msgid ""
"Learning steps to add a new replica node, remove an existing replica, and repl"
"ace a replica with new one, for your existing [Droonga][] cluster."
msgstr ""
"既存の[Droonga][]クラスタについて、新しいreplicaを追加し、既存のreplicaを削除し、および、既存のreplicaを新しいreplica"
"で置き換えるための手順を学ぶこと。"

msgid "## Precondition"
msgstr "## 前提条件"

msgid ""
"* You must have an existing Droonga cluster with some data.\n"
"  Please complete the [\"getting started\" tutorial](../groonga/) before this.\n"
"* You must know how to duplicate data between multiple clusters.\n"
"  Please complete the [\"How to backup and restore the database?\" tutorial](../"
"dump-restore/) before this."
msgstr ""
"* 何らかのデータが格納されている状態の[Droonga][]クラスタがあること。\n"
"  このチュートリアルを始める前に、[「使ってみる」のチュートリアル](../groonga/)を完了しておいて下さい。\n"
"* 複数のクラスタの間でのデータの複製方法を把握していること。\n"
"  このチュートリアルを始める前に、[バックアップと復元のチュートリアル](../dump-restore/)を完了しておいて下さい。"

msgid ""
"This tutorial assumes that there are two existing Droonga nodes prepared by th"
"e [first tutorial](../groonga/): `node0` (`192.168.100.50`) and `node1` (`192."
"168.100.51`), and there is another computer `node2` (`192.168.100.52`) for a n"
"ew node.\n"
"If you have Droonga nodes with other names, read `node0`, `node1` and `node2` "
"in following descriptions as yours."
msgstr ""
"このチュートリアルでは、[最初のチュートリアル](../groonga/)で準備した2つの既存のDroongaノード：`node0` (`192.168.1"
"00.50`) 、 `node1` (`192.168.100.51`) と、新しいノードとして使うもう1台のコンピュータ `node2` (`192.16"
"8.100.52`) があると仮定します。\n"
"あなたの手元にあるDroongaノードがこれとは異なる名前である場合には、以下の説明の中の`node0`、`node1`、`node2`は実際の物に読み替え"
"て下さい。"

msgid "## What's \"replica\"?"
msgstr "## 「replica」とは？"

msgid "There are two axes, \"replica\" and \"slice\", for Droonga nodes."
msgstr "Droongaのノードの集合には、「replica」と「slice」という2つの軸があります。"

msgid ""
"All \"replica\" nodes have completely equal data, so they can process your reque"
"sts (ex. \"search\") parallelly.\n"
"You can increase the capacity of your cluster to process increasing requests, "
"by adding new replicas."
msgstr ""
"「replica」のノード群は、完全に同一のデータを持っており、検索などのリクエストを各ノードが並行して処理する事ができます\n"
"新しいreplicaを追加する事によって、増加するリクエストに対して処理能力を増強することができます。"

msgid ""
"On the other hand, \"slice\" nodes have different data, for example, one node co"
"ntains data of the year 2013, another has data of 2014.\n"
"You can increase the capacity of your cluster to store increasing data, by add"
"ing new slices."
msgstr ""
"他方、「slice」のノード群はそれぞれ異なるデータを持ちます（例えば、あるノードは2013年のデータ、別のノードは2014年のデータ、という具合です）。\n"
"新しいsliceを追加する事によって、増大するデータ量に対してクラスタとしての容量を拡大することができます。"

msgid ""
"Currently, for a Droonga cluster which is configured as a Groonga compatible s"
"ystem, only replicas can be added, but slices cannot be done.\n"
"We'll improve extensibility for slices in the future."
msgstr ""
"現在の所、Groonga互換のシステムとして設定されたDroongaクラスタについては、replicaを追加することはできますが、sliceを追加することは"
"できません。\n"
"この点については将来のバージョンで改善する予定です。"

msgid ""
"Anyway, this tutorial explains how to add a new replica node to an existing Dr"
"oogna cluster.\n"
"Here we go!"
msgstr ""
"ともかく、このチュートリアルでは既存のDroongaクラスタに新しいreplicaを追加する手順を解説します。\n"
"早速始めましょう。"

msgid "## Add a new replica node to an existing cluster"
msgstr "## 既存のクラスタに新しいreplicaノードを追加する"

msgid ""
"In this case you don't have to stop the cluster working, for any read-only req"
"uests like \"search\".\n"
"You can add a new replica, in the backstage, without downing your service."
msgstr ""
"このケースでは、検索のように読み取りのみを行うリクエストに対しては、クラスタの動作を止める必要はありません。\n"
"サービスを停止することなく、その裏側でシームレスに新しいreplicaを追加することができます。"

msgid ""
"On the other hand, you have to stop inpouring of new data to the cluster until"
" the new node starts working.\n"
"(In the future we'll provide mechanism to add new nodes completely silently wi"
"thout any stopping of data-flow, but currently can't.)"
msgstr ""
"その一方で、クラスタへの新しいデータの流入は、新しいノードが動作を始めるまでの間停止しておく必要があります。\n"
"（将来的には、新しいノードを完全に無停止で追加できるようにする予定ですが、今のところはそれはできません。）"

msgid ""
"Assume that there is a Droonga cluster constructed with two replica nodes `nod"
"e0` and `node1`, and we are going to add a new replica node `node2`."
msgstr ""
"ここでは、`node0` と `node1` の2つのreplicaノードからなるDroongaクラスタがあり、新しいreplicaノードとして `node"
"2` を追加すると仮定します。"

msgid "### Setup a new node"
msgstr "### 新しいノードをセットアップする"

msgid "First, prepare a new computer, install required softwares and configure them."
msgstr "まず、新しいコンピュータをセットアップし、必要なソフトウェアのインストールと設定を済ませます。"

msgid ""
"~~~\n"
"(on node2)\n"
"# curl https://raw.githubusercontent.com/droonga/droonga-engine/master/install"
".sh | \\\n"
"    HOST=node2 bash\n"
"# curl https://raw.githubusercontent.com/droonga/droonga-http-server/master/in"
"stall.sh | \\\n"
"    ENGINE_HOST=node2 HOST=node2 bash\n"
"~~~"
msgstr ""

msgid ""
"Note, you cannot add a non-empty node to an existing cluster.\n"
"If the computer was used as a Droonga node in old days, then you must clear ol"
"d data at first."
msgstr ""
"注意点として、空でないノードを既存のクラスタに追加することはできません。\n"
"もしそのコンピュータがかつてDroongaノードとして使われていた事があった場合には、最初に古いデータを消去する必要があります。"

msgid ""
"~~~\n"
"(on node2)\n"
"# droonga-engine-configure --quiet \\\n"
"                           --clear --reset-config --reset-catalog \\\n"
"                           --host=node2\n"
"# droonga-http-server-configure --quiet --reset-config \\\n"
"                                --droonga-engine-host-name=node2 \\\n"
"                                --receive-host-name=node2\n"
"~~~"
msgstr ""

msgid "Let's start services."
msgstr "では、サービスを起動しましょう。"

msgid ""
"~~~\n"
"(on node2)\n"
"# service start droonga-engine\n"
"# service start droonga-http-server\n"
"~~~"
msgstr ""

msgid ""
"Currently, the new node doesn't work as a node of the existing cluster.\n"
"You can confirm that, via the `system.status` command:"
msgstr ""
"この時点で、この新しいノードは既存のクラスタのノードとしては動作していません。\n"
"この事は、`system.status`コマンドを通じて確認できます:"

msgid ""
"~~~\n"
"$ curl \"http://node0:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node1:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"$ curl \"http://node1:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node1:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"$ curl \"http://node2:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node2:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"~~~"
msgstr ""

msgid "### Suspend inpouring of \"write\" requests"
msgstr "### 書き込みを伴うリクエストの流入を一時的に停止する"

msgid ""
"Before starting to change cluster composition, you must suspend inpouring of \""
"write\" requests to the cluster, because we have to synchronize data to the new"
" replica.\n"
"Otherwise, the new added replica will contain incomplete data and results for "
"requests to the cluster become unstable."
msgstr ""
"新しいreplicaとの間でデータを完全に同期する必要があるので、クラスタの構成を変更する前に、クラスタへのデータの書き込みを行うリクエストの流入を一時停止"
"する必要があります。\n"
"そうしないと、新しく追加したreplicaが中途半端なデータしか持たない矛盾した状態となってしまい、リクエストに対してクラスタが返す処理結果が不安定になりま"
"す。"

msgid ""
"What's \"write\" request?\n"
"In particular, these commands modify data in the cluster:"
msgstr "データの書き込みを伴うリクエストとは、具体的には、クラスタ内のデータを変更する以下のコマンドです:"

msgid ""
" * `add`\n"
" * `column_create`\n"
" * `column_remove`\n"
" * `delete`\n"
" * `load`\n"
" * `table_create`\n"
" * `table_remove`"
msgstr ""

msgid ""
"If you load new data via the `load` command triggered by a batch script starte"
"d as a cronjob, disable the job.\n"
"If a crawler agent adds new data via the `add` command, stop it.\n"
"If you put a fluentd as a buffer between crawler or loader and the cluster, st"
"op outgoing messages from the buffer."
msgstr ""
"cronjobとして実行されるバッチスクリプトによって `load` コマンド経由で新しいデータを投入している場合は、cronjobを停止して下さい。\n"
"クローラが `add` コマンド経由で新しいデータを投入している場合は、クローラを停止して下さい。\n"
"あるいは、クローラやローダーとクラスタの間にFluentdを置いてバッファとして利用しているのであれば、バッファからのメッセージ出力を停止して下さい。"

msgid ""
"If you are reading this tutorial sequentially after the [previous topic](../du"
"mp-restore/), there is no incoming requests, so you have nothing to do."
msgstr ""
"[前項](../dump-restore/)から順番にチュートリアルを読んでいる場合、クラスタに流入しているリクエストはありませんので、ここでは特に何もする"
"必要はありません。"

msgid "### Joining a new replica node to the cluster"
msgstr "### 新しいreplicaをクラスタに参加させる"

msgid ""
"To add a new replica node to an existing cluster, you just run a command `droo"
"nga-engine-join` on one of existing replica nodes or the new replica node, in "
"the directory the `catalog.json` is located, like:"
msgstr ""
"新しいreplicaノードを既存のクラスタに追加するには、いずれかの既存のノードもしくは新しいreplicaノードのいずれかにおいて、`catalog.js"
"on` が置かれているディレクトリで、`droonga-engine-join` コマンドを実行します:"

msgid ""
"~~~\n"
"(on node2)\n"
"$ droonga-engine-join --host=node2 \\\n"
"                      --replica-source-host=node0\n"
"Joining new replica to the cluster...\n"
"...\n"
"Update existing hosts in the cluster...\n"
"...\n"
"Done.\n"
"~~~"
msgstr ""

msgid ""
" * You must specify the host name of the new replica node, via the `--host` op"
"tion.\n"
" * You must specify the host name of an existing node of the cluster, via the "
"`--replica-source-host` option."
msgstr ""
" * `--host` オプションで、その新しいreplicaノードのホスト名を指定して下さい。\n"
" * `--replica-source-host` オプションで、クラスタ中の既存のノードの1つのホスト名を指定して下さい。"

msgid ""
"Then the command automatically starts to synchronize all data of the cluster t"
"o the new replica node.\n"
"After data is successfully synchronized, the node restarts and joins to the cl"
"uster automatically.\n"
"All nodes' `catalog.json` are also updated, and now, yes, the new node starts "
"working as a replica in the cluster."
msgstr ""
"コマンドを実行すると、自動的に、クラスタのデータが新しいreplicaノードへと同期され始めます。\n"
"データの同期が完了すると、ノードが自動的に再起動してクラスタに参加します。\n"
"すべてのノードの`catalog.json`も同時に更新され、この時点をもって、新しいノードは晴れてそのクラスタのreplicaノードとして動作し始めます。"

msgid ""
"You can confirm that they are working as a cluster, via the `system.status` co"
"mmand:"
msgstr "これで、ノードがクラスタに参加しました。この事は `system.status` コマンドで確かめられます:"

msgid ""
"~~~\n"
"$ curl \"http://node0:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node1:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node2:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"~~~"
msgstr ""

msgid ""
"Note that adding an extra unique parameter for each request, to bypass old res"
"posne caches."
msgstr "古いレスポンスキャッシュを無視するために、各リクエストに追加の一意なパラメータを加えていることに注意して下さい。"

msgid "### Resume inpouring of \"write\" requests"
msgstr "### 書き込みを伴うリクエストの流入を再開する"

msgid ""
"OK, it's the time.\n"
"Because all replica nodes are completely synchronized, the cluster now can pro"
"cess any request stably.\n"
"Resume inpouring of requests which can modify the data in the cluster - cronjo"
"bs, crawlers, buffers, and so on."
msgstr ""
"さて、準備ができました。\n"
"すべてのreplicaは完全に同期した状態となっているので、このクラスタはリクエストを安定して処理できます。\n"
"cronjobを有効化する、クローラの動作を再開する、バッファからのメッセージ送出を再開する、などの操作を行って、クラスタ内のデータを変更するリクエストの流"
"入を再開して下さい。"

msgid "With that, a new replica node has joined to your Droonga cluster successfully."
msgstr "以上で、Droongaクラスタに新しいreplicaノードを無事参加させる事ができました。"

msgid "## Remove an existing replica node from an existing cluster"
msgstr "## 既存のクラスタからreplicaノードを削除する"

msgid ""
"A Droonga node can die by various fatal reasons - for example, OOM killer, dis"
"k-full error, troubles around its hardware, etc.\n"
"Because nodes in a Droonga cluster observe each other and they stop delivering"
" messages to dead nodes automatically, the cluster keeps working even if there"
" are some dead nodes.\n"
"Then you have to remove dead nodes from the cluster."
msgstr ""
"Droongaノードは、メモリ不足、ディスク容量不足、ハードウェア障害など、様々な致命的な理由によって動作しなくなり得ます。\n"
"Droongaクラスタ内のノードは互いに監視しあっており、動作しなくなったノードに対してはメッセージの配送を自動的に停止して、動作しないノードがあってもクラ"
"スタ全体としては動作し続けるようになっています。\n"
"このような時には、動作していないノードを取り除く必要があります。"

msgid ""
"Of course, even if a node is still working, you may plan to remove it to reuse"
" for another purpose."
msgstr "もちろん、他の目的に転用したいといった理由から、正常動作中のノードを取り除きたいと考える場合もあるでしょう。"

msgid ""
"Assume that there is a Droonga cluster constructed with trhee replica nodes `n"
"ode0`, `node1` and `node2`, and planning to remove the last node `node2` from "
"the cluster."
msgstr ""
"ここでは、`node0` 、 `node1` 、`node2` の3つのreplicaノードからなるDroongaクラスタがあり、最後のノード `node2"
"` をクラスタから離脱させようとしていると仮定します。"

msgid "### Unjoin an existing replica from the cluster"
msgstr "### 既存のreplicaをクラスタから分離する"

msgid ""
"To remove a replica from an existing cluster, you just run the `droonga-engine"
"-unjoin` command on any existing node in the cluster, in the directory the `ca"
"talog.json` is located, like:"
msgstr ""
"新しいreplicaノードを既存のクラスタから削除するには、クラスタ内のいずれかのノードの上で、`catalog.json` が置かれたディレクトリにおいて"
" `droonga-engine-unjoin` コマンドを実行します:"

msgid ""
"~~~\n"
"(on node0)\n"
"$ droonga-engine-unjoin --host=node2\n"
"Unjoining replica from the cluster...\n"
"...\n"
"Done.\n"
"~~~"
msgstr ""

msgid ""
" * You must specify the host name or the IP address of an existing node to be "
"removed from the cluster, via the `--host` option.\n"
" * You must run the command in the directory `catalog.json` is located, or spe"
"cify path to the directory via the `--base-dir` option."
msgstr ""
" * `--host` オプションで、クラスタから削除するノードのホスト名またはIPアドレスを指定して下さい。\n"
" * コマンドは `catalog.json` が置かれたディレクトリで実行するか、もしくはそのディレクトリのパスを `--base-dir` オプションで"
"指定して下さい。"

msgid ""
"Then the specified node automatically unjoins from the cluster, and all nedes'"
" `catalog.json` are also updated.\n"
"Now, the node has been successfully unjoined from the cluster."
msgstr ""
"すると、ノードがクラスタから自動的に離脱し、すべてのノードの `catalog.json` も同時に更新されます。\n"
"これで、ノードはクラスタから無事離脱しました。"

msgid ""
"You can confirm that the `node2` is successfully unjoined, via the `system.sta"
"tus` command:"
msgstr "これで、ノード `node2` がクラスタから離脱しました。この事は `system.status` コマンドで確かめられます:"

msgid ""
"~~~\n"
"$ curl \"http://node0:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node1:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"$ curl \"http://node1:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node1:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"$ curl \"http://node2:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node1:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"~~~"
msgstr ""

msgid ""
"Look at the point that the `node2` also says `node2` is not a member of the cl"
"uster.\n"
"This is the difference between a node unjoined from a cluster and a new node."
msgstr ""
"`node2` までもが、`node2` がクラスタの一員ではないと報告していることに注目して下さい。\n"
"これは、クラスタから離脱したノードと新しいノードとの違いです。"

msgid "## Replace an existing replica node in a cluster with a new one"
msgstr "## クラスタ内の既存のreplicaノードを新しいreplicaノードで置き換える"

msgid "Replacing of nodes is a combination of those instructions above."
msgstr "ノードの置き換えは、上記の手順の組み合わせで行います。"

msgid ""
"Assume that there is a Droonga cluster constructed with two replica nodes `nod"
"e0` and `node1`, the node `node1` is unstable, and planning to replace it with"
" a new node `node2`."
msgstr ""
"ここでは、`node0` と `node1` の2つのreplicaノードからなるDroongaクラスタがあり、`node1` が不安定で、それを新しいre"
"plicaノード `node2` で置き換えようとしていると仮定します。"

msgid ""
"First, remove the unstable node.\n"
"Remove the node from the cluster, like:"
msgstr "まず、不安定になっているノードを取り除きます。以下のようにしてクラスタからノードを離脱させて下さい:"

msgid ""
"~~~\n"
"(on node0)\n"
"$ droonga-engine-unjoin --host=node1\n"
"~~~"
msgstr ""

msgid "Refresh response caches:"
msgstr "レスポンスキャッシュを空にします:"

msgid ""
"Now the node has been gone.\n"
"You can confirm that via the `system.status` command:"
msgstr "これで、ノードがクラスタから離脱しました。この事は `system.status` コマンドで確かめられます:"

msgid ""
"~~~\n"
"$ curl \"http://node0:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"~~~"
msgstr ""

msgid "### Add a new replica"
msgstr "### 新しいreplicaを追加する"

msgid ""
"Next, setup the new replica `node2`.\n"
"Install required packages, generate the `catalog.json`, and start services."
msgstr ""
"次に、新しいreplica `node2`を用意します。\n"
"必要なパッケージをインストールし、`catalog.json`を生成して、サービスを起動します。"

msgid ""
"If the computer was used as a Droonga node in old days, then you must clear ol"
"d data instead of installation:"
msgstr "そのコンピュータがかつてDroongaノードの一員だったことがある場合は、インストール作業の代わりに、古いデータを消去する必要があります:"

msgid "Then, join the node to the cluster."
msgstr "そうしたら、そのノードをクラスタに参加させましょう。"

msgid ""
"~~~\n"
"(on node2)\n"
"$ droonga-engine-join --host=node2 \\\n"
"                      --replica-source-host=node0\n"
"~~~"
msgstr ""

msgid ""
"Finally a Droonga cluster constructed with two nodes `node0` and `node2` is he"
"re."
msgstr "最終的に、`node0` と `node2` の2つのノードからなるDroongaクラスタができあがりました。"

msgid "You can confirm that, via the `system.status` command:"
msgstr "この事は、`system.status` コマンドの結果を見ると確認できます:"

msgid ""
"~~~\n"
"$ curl \"http://node0:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node2:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"$ curl \"http://node2:10041/droonga/system/status?_=$(date +%s)\" | jq \".\"\n"
"{\n"
"  \"nodes\": {\n"
"    \"node0:10031/droonga\": {\n"
"      \"live\": true\n"
"    },\n"
"    \"node2:10031/droonga\": {\n"
"      \"live\": true\n"
"    }\n"
"  }\n"
"}\n"
"~~~"
msgstr ""

msgid "## Conclusion"
msgstr "## まとめ"

msgid ""
"In this tutorial, you did add a new replica node to an existing [Droonga][] cl"
"uster.\n"
"Moreover, you did remove an existing replica, and did replace a replica with a"
" new one."
msgstr ""
"このチュートリアルでは、既存の[Droonga][]クラスタに新しいreplicaノードを追加する方法を学びました。\n"
"また、既存のreplicaを取り除く方法と、既存のreplicaを新しいreplicaで置き換える方法も学びました。"

msgid ""
"  [Ubuntu]: http://www.ubuntu.com/\n"
"  [Droonga]: https://droonga.org/\n"
"  [Groonga]: http://groonga.org/\n"
"  [command reference]: ../../reference/commands/"
msgstr ""
